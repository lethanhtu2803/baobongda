{"ast":null,"code":"var _jsxFileName = \"D:\\\\Downloads\\\\my-app\\\\my-app\\\\my-app\\\\src\\\\pages\\\\Test\\\\TestPage.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from 'react';\nimport { useLocation, useNavigate, useParams } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst TestPage = () => {\n  _s();\n  const location = useLocation();\n  const {\n    articleId\n  } = useParams();\n  const iframeRef = useRef(null);\n  const [url, setUrl] = useState(articleId);\n  const [content, setContent] = useState('');\n  const [error, setError] = useState(null);\n  const navigate = useNavigate();\n  useEffect(() => {\n    const fetchContent = async () => {\n      try {\n        const response = await fetch(`https://thingproxy.freeboard.io/fetch/${encodeURIComponent(url)}`);\n        if (!response.ok) {\n          throw new Error(`Failed to fetch: ${response.status} ${response.statusText}`);\n        }\n        const text = await response.text();\n\n        // Parse the HTML and remove header, footer, and navigation\n        const parser = new DOMParser();\n        const doc = parser.parseFromString(text, 'text/html');\n        const header = doc.querySelector('header');\n        const footer = doc.querySelector('footer');\n        const nav = doc.querySelector('nav');\n        if (header) header.remove();\n        if (footer) footer.remove();\n        if (nav) nav.remove();\n\n        // Extract styles and scripts\n        const styles = Array.from(doc.querySelectorAll('link[rel=\"stylesheet\"], style')).map(style => style.outerHTML).join('\\n');\n        const scripts = Array.from(doc.querySelectorAll('script')).map(script => script.outerHTML).join('\\n');\n\n        // Get the remaining content\n        const bodyContent = doc.body.innerHTML;\n\n        // Combine styles, content, and scripts with additional styles to prevent overflow\n        const fullContent = `\n                    <html>\n                    <head>\n                        ${styles}\n                        <style>\n                            body, html {\n                                margin: 0;\n                                padding: 0;\n                                overflow-x: hidden;\n                                width: 100%;\n                            }\n                            body > * {\n                                max-width: 100%;\n                               \n                            }\n                            #aswift_1_host, .adscontent {\n                                display: none !important;\n                            }\n                        </style>\n                    </head>\n                    <body>\n                        ${bodyContent}\n                        ${scripts}\n                        <script>\n                            function sendHeight() {\n                                window.parent.postMessage({ type: 'resize', height: document.body.scrollHeight }, '*');\n                            }\n                            window.addEventListener('load', sendHeight);\n                            window.addEventListener('resize', sendHeight);\n                            \n                            // Intercept link clicks and send URL to parent\n                            document.addEventListener('click', function(event) {\n                                // Find the nearest anchor element in case the click is on a child element\n                                const anchor = event.target.closest('a');\n                                if (anchor) {\n                                    event.preventDefault();\n                                    const url = new URL(anchor.href, document.baseURI).href; // Resolve relative URLs\n                                    console.log(url);\n                                    window.parent.postMessage({ type: 'navigate', url: url }, '*');\n                                }\n                            });\n                            \n                        </script>\n                    </body>\n                    </html>\n                `;\n        setContent(fullContent);\n        setError(null); // Clear any previous errors\n      } catch (error) {\n        console.error('Failed to fetch content', error);\n        setError(error.message);\n      }\n    };\n    fetchContent();\n  }, [url]);\n  useEffect(() => {\n    const handleResize = event => {\n      if (event.data.type === 'resize') {\n        if (iframeRef.current) {\n          iframeRef.current.style.height = `${event.data.height}px`;\n        }\n      }\n    };\n\n    // Handle link clicks from iframe\n    const handleLinkClick = event => {\n      if (event.data.type === 'navigate') {\n        const baseUrl = 'https://bongda24h.vn';\n        const urlPath = new URL(event.data.url).pathname;\n        const fullUrl = `${baseUrl}${urlPath}`;\n        console.log(fullUrl);\n        setUrl(fullUrl);\n        navigate(`/test/${encodeURIComponent(url)}`);\n      }\n    };\n\n    // Listen for resize messages from iframe\n    window.addEventListener('message', handleResize);\n\n    // Listen for link click messages from iframe\n    window.addEventListener('message', handleLinkClick);\n    return () => {\n      window.removeEventListener('message', handleResize);\n      window.removeEventListener('message', handleLinkClick);\n    };\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"iframe-container\",\n    style: {\n      marginRight: 0\n    },\n    children: error ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"alert alert-danger\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 21\n    }, this) : /*#__PURE__*/_jsxDEV(\"iframe\", {\n      ref: iframeRef,\n      srcDoc: content,\n      style: {\n        width: '100%',\n        border: 'none'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 21\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 136,\n    columnNumber: 9\n  }, this);\n};\n_s(TestPage, \"RyPD14SKmu3TFu3JOPvoj/7Eb6o=\", false, function () {\n  return [useLocation, useParams, useNavigate];\n});\n_c = TestPage;\nexport default TestPage;\nvar _c;\n$RefreshReg$(_c, \"TestPage\");","map":{"version":3,"names":["React","useEffect","useRef","useState","useLocation","useNavigate","useParams","jsxDEV","_jsxDEV","TestPage","_s","location","articleId","iframeRef","url","setUrl","content","setContent","error","setError","navigate","fetchContent","response","fetch","encodeURIComponent","ok","Error","status","statusText","text","parser","DOMParser","doc","parseFromString","header","querySelector","footer","nav","remove","styles","Array","from","querySelectorAll","map","style","outerHTML","join","scripts","script","bodyContent","body","innerHTML","fullContent","console","message","handleResize","event","data","type","current","height","handleLinkClick","baseUrl","urlPath","URL","pathname","fullUrl","log","window","addEventListener","removeEventListener","className","marginRight","children","fileName","_jsxFileName","lineNumber","columnNumber","ref","srcDoc","width","border","_c","$RefreshReg$"],"sources":["D:/Downloads/my-app/my-app/my-app/src/pages/Test/TestPage.jsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\r\nimport { useLocation, useNavigate, useParams,  } from 'react-router-dom';\r\n\r\nconst TestPage = () => {\r\n    const location = useLocation();\r\n    const { articleId } = useParams();\r\n    const iframeRef = useRef(null);\r\n    const [url, setUrl] = useState(articleId);\r\n    const [content, setContent] = useState('');\r\n    const [error, setError] = useState(null);\r\n    const navigate = useNavigate();\r\n\r\n    useEffect(() => {\r\n        const fetchContent = async () => {\r\n            try {\r\n                const response = await fetch(`https://thingproxy.freeboard.io/fetch/${encodeURIComponent(url)}`);\r\n                if (!response.ok) {\r\n                    throw new Error(`Failed to fetch: ${response.status} ${response.statusText}`);\r\n                }\r\n                const text = await response.text();\r\n\r\n                // Parse the HTML and remove header, footer, and navigation\r\n                const parser = new DOMParser();\r\n                const doc = parser.parseFromString(text, 'text/html');\r\n                const header = doc.querySelector('header');\r\n                const footer = doc.querySelector('footer');\r\n                const nav = doc.querySelector('nav');\r\n                if (header) header.remove();\r\n                if (footer) footer.remove();\r\n                if (nav) nav.remove();\r\n\r\n                // Extract styles and scripts\r\n                const styles = Array.from(doc.querySelectorAll('link[rel=\"stylesheet\"], style'))\r\n                    .map(style => style.outerHTML)\r\n                    .join('\\n');\r\n                const scripts = Array.from(doc.querySelectorAll('script'))\r\n                    .map(script => script.outerHTML)\r\n                    .join('\\n');\r\n\r\n                // Get the remaining content\r\n                const bodyContent = doc.body.innerHTML;\r\n                \r\n                // Combine styles, content, and scripts with additional styles to prevent overflow\r\n                const fullContent = `\r\n                    <html>\r\n                    <head>\r\n                        ${styles}\r\n                        <style>\r\n                            body, html {\r\n                                margin: 0;\r\n                                padding: 0;\r\n                                overflow-x: hidden;\r\n                                width: 100%;\r\n                            }\r\n                            body > * {\r\n                                max-width: 100%;\r\n                               \r\n                            }\r\n                            #aswift_1_host, .adscontent {\r\n                                display: none !important;\r\n                            }\r\n                        </style>\r\n                    </head>\r\n                    <body>\r\n                        ${bodyContent}\r\n                        ${scripts}\r\n                        <script>\r\n                            function sendHeight() {\r\n                                window.parent.postMessage({ type: 'resize', height: document.body.scrollHeight }, '*');\r\n                            }\r\n                            window.addEventListener('load', sendHeight);\r\n                            window.addEventListener('resize', sendHeight);\r\n                            \r\n                            // Intercept link clicks and send URL to parent\r\n                            document.addEventListener('click', function(event) {\r\n                                // Find the nearest anchor element in case the click is on a child element\r\n                                const anchor = event.target.closest('a');\r\n                                if (anchor) {\r\n                                    event.preventDefault();\r\n                                    const url = new URL(anchor.href, document.baseURI).href; // Resolve relative URLs\r\n                                    console.log(url);\r\n                                    window.parent.postMessage({ type: 'navigate', url: url }, '*');\r\n                                }\r\n                            });\r\n                            \r\n                        </script>\r\n                    </body>\r\n                    </html>\r\n                `;\r\n                \r\n                setContent(fullContent);\r\n                setError(null); // Clear any previous errors\r\n            } catch (error) {\r\n                console.error('Failed to fetch content', error);\r\n                setError(error.message);\r\n            }\r\n        };\r\n\r\n        fetchContent();\r\n    }, [url]);\r\n\r\n    useEffect(() => {\r\n        const handleResize = (event) => {\r\n            if (event.data.type === 'resize') {\r\n                if (iframeRef.current) {\r\n                    iframeRef.current.style.height = `${event.data.height}px`;\r\n                }\r\n            }\r\n        };\r\n\r\n        // Handle link clicks from iframe\r\n        const handleLinkClick = (event) => {\r\n            if (event.data.type === 'navigate') {\r\n                const baseUrl = 'https://bongda24h.vn';\r\n                const urlPath = new URL(event.data.url).pathname;\r\n                const fullUrl = `${baseUrl}${urlPath}`;\r\n                console.log(fullUrl);\r\n                setUrl(fullUrl);\r\n                navigate(`/test/${encodeURIComponent(url)}`);\r\n            }\r\n        };\r\n\r\n        // Listen for resize messages from iframe\r\n        window.addEventListener('message', handleResize);\r\n\r\n        // Listen for link click messages from iframe\r\n        window.addEventListener('message', handleLinkClick);\r\n\r\n        return () => {\r\n            window.removeEventListener('message', handleResize);\r\n            window.removeEventListener('message', handleLinkClick);\r\n        };\r\n    }, []);\r\n\r\n    return (\r\n        <div className='iframe-container' style={{ marginRight: 0 }}>\r\n                {error ? (\r\n                    <div className='alert alert-danger'>\r\n                        {error}\r\n                    </div>\r\n                ) : (\r\n                    <iframe\r\n                        ref={iframeRef}\r\n                        srcDoc={content}\r\n                        style={{ width: '100%', border: 'none' }}\r\n                        \r\n                    ></iframe>\r\n                )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default TestPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}